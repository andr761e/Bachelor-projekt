import pandas as pd
import numpy as np

team_names = [
    "Aachen", "Augsburg", "Bayern Munich", "Bielefeld", "Bochum", "Braunschweig",
    "Cottbus", "Darmstadt", "Dortmund", "Duisburg", "Ein Frankfurt", "FC Koln",
    "Fortuna Dusseldorf", "Freiburg", "Greuther Furth", "Hamburg", "Hannover",
    "Hansa Rostock", "Heidenheim", "Hertha", "Hoffenheim", "Holstein Kiel",
    "Ingolstadt", "Kaiserslautern", "Karlsruhe", "Leverkusen", "M'gladbach",
    "Mainz", "Nurnberg", "Paderborn", "RB Leipzig", "Schalke 04", "St Pauli",
    "Stuttgart", "Union Berlin", "Werder Bremen", "Wolfsburg"
]

# Opret et dictionary med hvert hold som nøgle, og et tomt dictionary for ELO-data
elo_dict = {team: {} for team in team_names}

alemannia_aachen_elo = {
    2006: 1780,
    2007: 1760,
    2008: 1740,
    2009: 1770,
    2010: 1700,
    2011: 1700,
    2012: 1620,
    2013: 1400,
    2014: 1300,
    2015: 1450,
    2016: 1375,
    2017: 1400,
    2018: 1350,
    2019: 1400,
    2020: 1250,
    2021: 1300,
    2022: 1400,
    2023: 1500,
    2024: 1550,
    2025: 1600
}
fc_augsburg_elo = {
    2006: 1700,
    2007: 1650,
    2008: 1650,
    2009: 1750,
    2010: 1800,
    2011: 1850,
    2012: 1850,
    2013: 1920,
    2014: 1910,
    2015: 1890,
    2016: 1875,
    2017: 1875,
    2018: 1850,
    2019: 1840,
    2020: 1830,
    2021: 1860,
    2022: 1835,
    2023: 1860,
    2024: 1900,
    2025: 1950
}
bayern_munchen_elo = {
    2006: 2050,
    2007: 2100,
    2008: 2150,
    2009: 2175,
    2010: 2200,
    2011: 2220,
    2012: 2350,
    2013: 2320,
    2014: 2250,
    2015: 2300,
    2016: 2280,
    2017: 2270,
    2018: 2350,
    2019: 2360,
    2020: 2300,
    2021: 2280,
    2022: 2260,
    2023: 2200,
    2024: 2240,
    2025: 2300
}
arminia_bielefeld_elo = {
    2006: 1820,
    2007: 1850,
    2008: 1820,
    2009: 1780,
    2010: 1720,
    2011: 1580,
    2012: 1550,
    2013: 1650,
    2014: 1600,
    2015: 1680,
    2016: 1700,
    2017: 1700,
    2018: 1720,
    2019: 1800,
    2020: 1820,
    2021: 1800,
    2022: 1700,
    2023: 1600,
    2024: 1650,
    2025: 1700
}
vfl_bochum_elo = {
    2006: 1900,
    2007: 1875,
    2008: 1850,
    2009: 1800,
    2010: 1750,
    2011: 1650,
    2012: 1620,
    2013: 1700,
    2014: 1650,
    2015: 1750,
    2016: 1700,
    2017: 1700,
    2018: 1680,
    2019: 1720,
    2020: 1800,
    2021: 1900,
    2022: 1890,
    2023: 1875,
    2024: 1850,
    2025: 1820
}
eintracht_braunschweig_elo = {
    2006: 1550,
    2007: 1560,
    2008: 1500,
    2009: 1580,
    2010: 1700,
    2011: 1750,
    2012: 1740,
    2013: 1700,
    2014: 1690,
    2015: 1760,
    2016: 1650,
    2017: 1550,
    2018: 1580,
    2019: 1550,
    2020: 1600,
    2021: 1600,
    2022: 1610,
    2023: 1630,
    2024: 1620,
    2025: 1600
}
energie_cottbus_elo = {
    2006: 1800,
    2007: 1825,
    2008: 1750,
    2009: 1720,
    2010: 1650,
    2011: 1700,
    2012: 1580,
    2013: 1500,
    2014: 1450,
    2015: 1380,
    2016: 1350,
    2017: 1450,
    2018: 1500,
    2019: 1450,
    2020: 1375,
    2021: 1400,
    2022: 1420,
    2023: 1480,
    2024: 1600,
    2025: 1700
}
sv_darmstadt_elo = {
    2006: 1500,
    2007: 1420,
    2008: 1400,
    2009: 1200,
    2010: 1150,
    2011: 1400,
    2012: 1450,
    2013: 1600,
    2014: 1720,
    2015: 1800,
    2016: 1750,
    2017: 1720,
    2018: 1750,
    2019: 1780,
    2020: 1800,
    2021: 1820,
    2022: 1850,
    2023: 1750,
    2024: 1730,
    2025: 1720
}
borussia_dortmund_elo = {
    2006: 1950,
    2007: 1900,
    2008: 2000,
    2009: 2000,
    2010: 2100,
    2011: 2180,
    2012: 2200,
    2013: 2050,
    2014: 2100,
    2015: 2150,
    2016: 2080,
    2017: 2150,
    2018: 2100,
    2019: 2150,
    2020: 2080,
    2021: 2150,
    2022: 2120,
    2023: 2170,
    2024: 2100,
    2025: 2050
}
msv_duisburg_elo = {
    2006: 1800,
    2007: 1750,
    2008: 1800,
    2009: 1720,
    2010: 1750,
    2011: 1700,
    2012: 1680,
    2013: 1550,
    2014: 1650,
    2015: 1580,
    2016: 1600,
    2017: 1500,
    2018: 1400,
    2019: 1450,
    2020: 1380,
    2021: 1400,
    2022: 1370,
    2023: 1400,
    2024: 1420,
    2025: 1450
}
eintracht_frankfurt_elo = {
    2006: 1850,
    2007: 1870,
    2008: 1780,
    2009: 1850,
    2010: 1780,
    2011: 1850,
    2012: 1950,
    2013: 1940,
    2014: 1970,
    2015: 1900,
    2016: 1920,
    2017: 2000,
    2018: 2050,
    2019: 1980,
    2020: 2050,
    2021: 2020,
    2022: 2000,
    2023: 1950,
    2024: 2020,
    2025: 2070
}
fc_koln_elo = {
    2006: 1750,
    2007: 1780,
    2008: 1800,
    2009: 1850,
    2010: 1780,
    2011: 1770,
    2012: 1850,
    2013: 1900,
    2014: 1950,
    2015: 2000,
    2016: 1920,
    2017: 1800,
    2018: 1820,
    2019: 1840,
    2020: 1850,
    2021: 1950,
    2022: 1930,
    2023: 1850,
    2024: 1830,
    2025: 1820
}
fortuna_dusseldorf_elo = {
    2006: 1550,
    2007: 1500,
    2008: 1580,
    2009: 1650,
    2010: 1750,
    2011: 1800,
    2012: 1770,
    2013: 1740,
    2014: 1650,
    2015: 1600,
    2016: 1630,
    2017: 1700,
    2018: 1800,
    2019: 1780,
    2020: 1730,
    2021: 1700,
    2022: 1760,
    2023: 1820,
    2024: 1780,
    2025: 1720
}
sc_freiburg_elo = {
    2006: 1800,
    2007: 1750,
    2008: 1800,
    2009: 1820,
    2010: 1900,
    2011: 2000,
    2012: 1920,
    2013: 1900,
    2014: 1910,
    2015: 1920,
    2016: 1890,
    2017: 1850,
    2018: 1920,
    2019: 1980,
    2020: 2050,
    2021: 2070,
    2022: 2000,
    2023: 1950,
    2024: 1980,
    2025: 2020
}
greuther_furth_elo = {
    2006: 1750,
    2007: 1750,
    2008: 1730,
    2009: 1740,
    2010: 1700,
    2011: 1850,
    2012: 1750,
    2013: 1800,
    2014: 1650,
    2015: 1630,
    2016: 1660,
    2017: 1620,
    2018: 1650,
    2019: 1780,
    2020: 1720,
    2021: 1680,
    2022: 1700,
    2023: 1690,
    2024: 1650,
    2025: 1600
}
hamburger_sv_elo = {
    2006: 1950,
    2007: 1980,
    2008: 1950,
    2009: 1970,
    2010: 1960,
    2011: 1900,
    2012: 1850,
    2013: 1900,
    2014: 1800,
    2015: 1850,
    2016: 1880,
    2017: 1800,
    2018: 1750,
    2019: 1700,
    2020: 1750,
    2021: 1820,
    2022: 1810,
    2023: 1820,
    2024: 1850,
    2025: 1900
}
hannover_96_elo = {
    2006: 1880,
    2007: 1900,
    2008: 1850,
    2009: 1800,
    2010: 1950,
    2011: 1950,
    2012: 1930,
    2013: 1880,
    2014: 1820,
    2015: 1750,
    2016: 1800,
    2017: 1850,
    2018: 1750,
    2019: 1720,
    2020: 1680,
    2021: 1700,
    2022: 1680,
    2023: 1750,
    2024: 1750,
    2025: 1740
}
hansa_rostock_elo = {
    2006: 1750,
    2007: 1740,
    2008: 1700,
    2009: 1600,
    2010: 1650,
    2011: 1580,
    2012: 1480,
    2013: 1450,
    2014: 1500,
    2015: 1480,
    2016: 1550,
    2017: 1600,
    2018: 1620,
    2019: 1660,
    2020: 1700,
    2021: 1750,
    2022: 1740,
    2023: 1650,
    2024: 1600,
    2025: 1580
}
heidenheim_elo = {
    2006: 1000,  # Holdet var ikke relevant på dette tidspunkt
    2007: 1000,
    2008: 1100,
    2009: 1400,
    2010: 1500,
    2011: 1600,
    2012: 1650,
    2013: 1680,
    2014: 1700,
    2015: 1720,
    2016: 1710,
    2017: 1700,
    2018: 1700,
    2019: 1750,
    2020: 1750,
    2021: 1800,
    2022: 1850,
    2023: 1900,
    2024: 1850,
    2025: 1820
}
hertha_bsc_elo = {
    2006: 1880,
    2007: 1880,
    2008: 1900,
    2009: 1850,
    2010: 1900,
    2011: 1800,
    2012: 1880,
    2013: 1850,
    2014: 1820,
    2015: 1900,
    2016: 1880,
    2017: 1890,
    2018: 1880,
    2019: 1850,
    2020: 1800,
    2021: 1780,
    2022: 1750,
    2023: 1700,
    2024: 1650,
    2025: 1600
}
hoffenheim_elo = {
    2006: 1550,
    2007: 1700,
    2008: 1850,
    2009: 1900,
    2010: 1880,
    2011: 1870,
    2012: 1850,
    2013: 1910,
    2014: 1900,
    2015: 1870,
    2016: 2000,
    2017: 1980,
    2018: 1970,
    2019: 1950,
    2020: 1910,
    2021: 1900,
    2022: 1900,
    2023: 1930,
    2024: 1900,
    2025: 1880
}
holstein_kiel_elo = {
    2006: 1520,
    2007: 1510,
    2008: 1540,
    2009: 1470,
    2010: 1430,
    2011: 1400,
    2012: 1500,
    2013: 1520,
    2014: 1600,
    2015: 1530,
    2016: 1650,
    2017: 1720,
    2018: 1680,
    2019: 1750,
    2020: 1700,
    2021: 1710,
    2022: 1720,
    2023: 1820,
    2024: 1780,
    2025: 1750
}
fc_ingolstadt_elo = {
    2006: 1450,
    2007: 1505,
    2008: 1540,
    2009: 1600,
    2010: 1650,
    2011: 1625,
    2012: 1700,
    2013: 1780,
    2014: 1850,
    2015: 1850,
    2016: 1750,
    2017: 1700,
    2018: 1650,
    2019: 1655,
    2020: 1550,
    2021: 1450,
    2022: 1500,
    2023: 1550,
    2024: 1550,
    2025: 1550,
}
fc_kaiserslautern_elo = {
    2006: 1800,
    2007: 1750,
    2008: 1700,
    2009: 1850,
    2010: 1750,
    2011: 1740,
    2012: 1760,
    2013: 1750,
    2014: 1700,
    2015: 1650,
    2016: 1600,
    2017: 1550,
    2018: 1500,
    2019: 1520,
    2020: 1600,
    2021: 1650,
    2022: 1700,
    2023: 1750,
    2024: 1800,
    2025: 1800,
}
karlsruher_sc_elo = {
    2006: 1800,
    2007: 1820,
    2008: 1780,
    2009: 1710,
    2010: 1600,
    2011: 1590,
    2012: 1720,
    2013: 1750,
    2014: 1800,
    2015: 1720,
    2016: 1570,
    2017: 1610,
    2018: 1630,
    2019: 1700,
    2020: 1680,
    2021: 1700,
    2022: 1730,
    2023: 1790,
    2024: 1750,
    2025: 1750,
}
bayer_leverkusen_elo = {
    2006: 1980,
    2007: 1920,
    2008: 1910,
    2009: 1930,
    2010: 1980,
    2011: 2040,
    2012: 2000,
    2013: 2060,
    2014: 2020,
    2015: 1950,
    2016: 1990,
    2017: 2030,
    2018: 2080,
    2019: 2000,
    2020: 2080,
    2021: 2030,
    2022: 2000,
    2023: 2230,
    2024: 2260,
    2025: 2260,
}
borussia_moenchengladbach_elo = {
    2006: 1750,
    2007: 1830,
    2008: 1790,
    2009: 1800,
    2010: 1850,
    2011: 2000,
    2012: 1950,
    2013: 2000,
    2014: 2080,
    2015: 2030,
    2016: 1980,
    2017: 1950,
    2018: 2000,
    2019: 2050,
    2020: 2030,
    2021: 1980,
    2022: 1950,
    2023: 1900,
    2024: 1930,
    2025: 1930,
}
mainz_elo = {
    2006: 1780,
    2007: 1800,
    2008: 1820,
    2009: 1850,
    2010: 1950,
    2011: 1900,
    2012: 1920,
    2013: 1960,
    2014: 1940,
    2015: 1980,
    2016: 1910,
    2017: 1930,
    2018: 1950,
    2019: 1970,
    2020: 1990,
    2021: 2010,
    2022: 2030,
    2023: 2030,
    2024: 2080,
    2025: 2080,
}
nurnberg_elo = {
    2006: 1900,
    2007: 1950,
    2008: 1850,
    2009: 1870,
    2010: 1830,
    2011: 1890,
    2012: 1900,
    2013: 1800,
    2014: 1720,
    2015: 1790,
    2016: 1700,
    2017: 1760,
    2018: 1680,
    2019: 1700,
    2020: 1720,
    2021: 1690,
    2022: 1650,
    2023: 1710,
    2024: 1700,
    2025: 1700,
}
paderborn_elo = {
    2006: 1650,
    2007: 1640,
    2008: 1600,
    2009: 1630,
    2010: 1670,
    2011: 1620,
    2012: 1700,
    2013: 1800,
    2014: 1790,
    2015: 1500,
    2016: 1400,
    2017: 1650,
    2018: 1740,
    2019: 1700,
    2020: 1720,
    2021: 1740,
    2022: 1750,
    2023: 1760,
    2024: 1770,
    2025: 1750,
}
rb_leipzig_elo = {
    2006: 1300,
    2007: 1300,
    2008: 1300,
    2009: 1300,
    2010: 1300,
    2011: 1400,
    2012: 1500,
    2013: 1650,
    2014: 1700,
    2015: 1800,
    2016: 2000,
    2017: 2020,
    2018: 2100,
    2019: 2150,
    2020: 2120,
    2021: 2140,
    2022: 2200,
    2023: 2190,
    2024: 2100,
    2025: 2100,
}
schalke_04_elo = {
    2006: 2020,
    2007: 2040,
    2008: 2060,
    2009: 1950,
    2010: 2020,
    2011: 2030,
    2012: 2000,
    2013: 2070,
    2014: 1950,
    2015: 1950,
    2016: 2000,
    2017: 2050,
    2018: 1900,
    2019: 1800,
    2020: 1700,
    2021: 1800,
    2022: 1850,
    2023: 1720,
    2024: 1680,
    2025: 1650,
}
st_pauli_elo = {
    2006: 1650,
    2007: 1660,
    2008: 1670,
    2009: 1800,
    2010: 1750,
    2011: 1800,
    2012: 1720,
    2013: 1680,
    2014: 1660,
    2015: 1690,
    2016: 1740,
    2017: 1650,
    2018: 1630,
    2019: 1650,
    2020: 1700,
    2021: 1780,
    2022: 1820,
    2023: 1870,
    2024: 1860,
    2025: 1850,
}
vfb_stuttgart_elo = {
    2006: 2050,
    2007: 1950,
    2008: 1900,
    2009: 2050,
    2010: 1920,
    2011: 2020,
    2012: 2070,
    2013: 1950,
    2014: 2000,
    2015: 1900,
    2016: 1850,
    2017: 1870,
    2018: 1950,
    2019: 1820,
    2020: 1890,
    2021: 1950,
    2022: 2000,
    2023: 2150,
    2024: 2070,
    2025: 2070,
}
union_berlin_elo = {
    2006: 1480,
    2007: 1520,
    2008: 1600,
    2009: 1700,
    2010: 1680,
    2011: 1690,
    2012: 1710,
    2013: 1700,
    2014: 1730,
    2015: 1760,
    2016: 1800,
    2017: 1770,
    2018: 1830,
    2019: 1900,
    2020: 1980,
    2021: 2050,
    2022: 2070,
    2023: 1950,
    2024: 1900,
    2025: 1900,
}
werder_bremen_elo = {
    2006: 2050,
    2007: 2040,
    2008: 2000,
    2009: 2100,
    2010: 1950,
    2011: 1900,
    2012: 1850,
    2013: 1870,
    2014: 1900,
    2015: 1950,
    2016: 2000,
    2017: 1900,
    2018: 1850,
    2019: 1840,
    2020: 1850,
    2021: 1870,
    2022: 1920,
    2023: 1950,
    2024: 1950,
    2025: 1950,
}
vfl_wolfsburg_elo = {
    2006: 1820,
    2007: 1850,
    2008: 2050,
    2009: 1950,
    2010: 1900,
    2011: 1900,
    2012: 1950,
    2013: 2000,
    2014: 2120,
    2015: 2000,
    2016: 1950,
    2017: 1900,
    2018: 1980,
    2019: 2000,
    2020: 2050,
    2021: 1950,
    2022: 2000,
    2023: 1900,
    2024: 1980,
    2025: 1980,
}
elo_dict["Aachen"] = alemannia_aachen_elo
elo_dict["Augsburg"] = fc_augsburg_elo
elo_dict["Bayern Munich"] = bayern_munchen_elo
elo_dict["Bielefeld"] = arminia_bielefeld_elo
elo_dict["Bochum"] = vfl_bochum_elo
elo_dict["Braunschweig"] = eintracht_braunschweig_elo
elo_dict["Cottbus"] = energie_cottbus_elo
elo_dict["Darmstadt"] = sv_darmstadt_elo
elo_dict["Dortmund"] = borussia_dortmund_elo
elo_dict["Duisburg"] = msv_duisburg_elo
elo_dict["Ein Frankfurt"] = eintracht_frankfurt_elo
elo_dict["FC Koln"] = fc_koln_elo
elo_dict["Fortuna Dusseldorf"] = fortuna_dusseldorf_elo
elo_dict["Freiburg"] = sc_freiburg_elo
elo_dict["Greuther Furth"] = greuther_furth_elo
elo_dict["Hamburg"] = hamburger_sv_elo
elo_dict["Hannover"] = hannover_96_elo
elo_dict["Hansa Rostock"] = hansa_rostock_elo
elo_dict["Heidenheim"] = heidenheim_elo
elo_dict["Hertha"] = hertha_bsc_elo
elo_dict["Hoffenheim"] = hoffenheim_elo
elo_dict["Holstein Kiel"] = holstein_kiel_elo
elo_dict["Ingolstadt"] = fc_ingolstadt_elo
elo_dict["Kaiserslautern"] = fc_kaiserslautern_elo
elo_dict["Karlsruhe"] = karlsruher_sc_elo
elo_dict["Leverkusen"] = bayer_leverkusen_elo
elo_dict["M'gladbach"] = borussia_moenchengladbach_elo
elo_dict["Mainz"] = mainz_elo
elo_dict["Nurnberg"] = nurnberg_elo
elo_dict["Paderborn"] = paderborn_elo
elo_dict["RB Leipzig"] = rb_leipzig_elo
elo_dict["Schalke 04"] = schalke_04_elo
elo_dict["St Pauli"] = st_pauli_elo
elo_dict["Stuttgart"] = vfb_stuttgart_elo
elo_dict["Union Berlin"] = union_berlin_elo
elo_dict["Werder Bremen"] = werder_bremen_elo
elo_dict["Wolfsburg"] = vfl_wolfsburg_elo

# Læs kun relevante kolonner fra Excel-arket
columns_to_use = ["Date", "HomeTeam", "AwayTeam"]
matches = pd.read_excel("Fase1_Datamanipulation/Bundesliga/tyske_kampe_scrapped.xlsx", usecols=columns_to_use)

# Initialiser lister til hjemme- og udebaneholdenes ELO
home_team_elo = []
away_team_elo = []

# Gennemløb rækkerne i Excel-arket
for index, row in matches.iterrows():
    # Hent dato og udtræk år (de sidste 2 cifre i datoen)
    date = row["Date"]
    year = int("20" + date[-2:])  # Eksempel: "xx/zz/03" -> "2003"

    # Hent holdnavne
    home_team = row["HomeTeam"]
    away_team = row["AwayTeam"]

    # Hent ELO for hjemme- og udehold baseret på år
    home_elo = elo_dict[home_team][year]
    away_elo = elo_dict[away_team][year]
    
    # Tilføj ELO til listerne
    home_team_elo.append(home_elo)
    away_team_elo.append(away_elo)

#Funktion at at normalisere
def normalize_elo(elo_values, new_min, new_max):
    min_elo = min(elo_values)
    max_elo = max(elo_values)
    normalized_values = [
        new_min + (elo - min_elo) / (max_elo - min_elo) * (new_max - new_min)
        for elo in elo_values
    ]
    return normalized_values

#Normaliser ELOs
home_team_elo_nor = normalize_elo(home_team_elo, 0, 5)
away_team_elo_nor = normalize_elo(away_team_elo, 0, 5)


# Opret en DataFrame med de to lister
elo_data = pd.DataFrame({
    "HomeTeamELO": home_team_elo_nor,
    "AwayTeamELO": away_team_elo_nor
})

# Gem DataFrame som et Excel-ark
elo_data.to_excel("Fase1_Datamanipulation/Bundesliga/tyske_elo_data.xlsx", index=False)
